<div class="min-h-screen flex items-center justify-center px-4 py-12">
  <div class="w-full max-w-md">
    <div class="bg-slate-800/60 backdrop-blur rounded-lg shadow-lg border border-slate-700/60 overflow-hidden">
      <div class="px-6 py-8 text-center">
        <img src="/assets/images/logo-amayo.svg" alt="logo" class="mx-auto h-12 w-12 mb-4" />
        <h1 class="text-2xl font-semibold text-slate-100">Sapphire</h1>
        <% if (user) { %>
          <p class="mt-3 text-sm text-slate-300 flex items-center justify-center gap-2">
            Logged in as
            <% const userAvatar = user?.avatar ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=64` : '/assets/images/default-avatar.png'; %>
            <img src="<%= userAvatar %>" alt="avatar" class="h-6 w-6 rounded-full ring-1 ring-slate-700" />
            <strong class="ml-2"><%= user.username %></strong>
          </p>
          <% if (typeof botAvailable !== 'undefined') { %>
            <p class="mt-2 text-xs text-slate-400">
              <% if (botAvailable) { %>
                Bot conectado — mostrando servidores donde el bot está presente. (<%= Array.isArray(guilds) ? guilds.length : 0 %>)
              <% } else { %>
                Bot no disponible — mostrando servidores desde OAuth (puede que el bot no esté en ellos). (<%= Array.isArray(guilds) ? guilds.length : 0 %>)
              <% } %>
            </p>
          <% } %>
        <% } %>
      </div>

      <div class="max-h-96 overflow-auto border-t border-slate-700/40">
        <ul class="divide-y divide-slate-700/50">
          <% if (Array.isArray(guilds) && guilds.length) { %>
            <% guilds.forEach(function(g) { %>
              <% const isSelected = String(selectedGuildId || '') === String(g.id); %>
              <% const iconUrl = g.icon ? `https://cdn.discordapp.com/icons/${g.id}/${g.icon}.png?size=128` : null; %>
              <li>
                <a href="/dashboard/<%= encodeURIComponent(g.id) %>" class="group flex items-center justify-between px-4 py-3 hover:bg-slate-700/40 transition-colors <%= isSelected ? 'bg-slate-700/60' : '' %>">
                  <div class="flex items-center gap-3">
                    <% if (iconUrl) { %>
                      <img src="<%= iconUrl %>" alt="icon" class="h-10 w-10 rounded-md object-cover bg-slate-600/40" onerror="this.style.display='none'" />
                    <% } else { %>
                      <div class="h-10 w-10 rounded-md flex items-center justify-center bg-gradient-to-br from-cyan-400 to-blue-500 text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-5 w-5 opacity-90"><path fill="currentColor" d="M12 2l3.09 6.26L22 9.27l-5 4.87L18.18 22 12 18.56 5.82 22 7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                      </div>
                    <% } %>
                    <div class="min-w-0">
                      <div class="text-slate-100 truncate font-medium"><%= g.name %></div>
                      <% if (g.addedAt) { %>
                        <div class="text-xs text-slate-400 truncate">Joined: <%= new Date(g.addedAt).toLocaleDateString('es-ES') %></div>
                      <% } %>
                    </div>
                  </div>
                  <div class="ml-4">
                    <svg class="h-5 w-5 text-slate-300 group-hover:text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg>
                  </div>
                </a>
              </li>
            <% }); %>
          <% } else { %>
            <li class="px-4 py-6 text-center text-slate-400">No servers available. Join a server or re-authenticate to refresh your guild list.</li>
          <% } %>
        </ul>
      </div>

      <div class="px-6 py-4 text-center text-xs text-slate-400">
        © 2021-<%= new Date().getFullYear() %> <span class="text-slate-300">Xge</span> • Terms • Privacy • Legal Notice
      </div>
    </div>
  </div>
</div>
